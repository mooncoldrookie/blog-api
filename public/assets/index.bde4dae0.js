import{_ as k}from"./index.95fe1fa6.js";import{u as I}from"./hooks.32207597.js";import{a as V}from"./hooks.0a3b5dfe.js";import{a as n,w as j,c as G,f as M,i as N,G as o,o as P}from"./index.a364b306.js";import"./menu.fa185c44.js";const $={name:"AllCategories"},L=Object.assign($,{setup(q){const{loading:y,pagination:f,fetchPageCategory:w,addCategory:_,updateCategory:C,deleteCategory:b,batchDeleteCategory:A}=V(),p=I(),i=n([]),r=async()=>{try{const{data:e,error:a,msg:s}=await w();if(a)return;i.value=e.list,f.page=e.page,f.total=e.total}catch(e){console.log(e)}};j(async()=>{await r()}),o("data",i),o("pagination",f),o("loading",y);const l=n(""),d=n(!1),t=n([]),c=n(!1),D=(e,a)=>{const s=t.value.findIndex(v=>v.id===a.id);s>=0?t.value.splice(s,1):t.value.push(a),c.value=i.value.every(v=>t.value.includes(v))},U=()=>{c.value=!c.value,c.value?t.value=i.value.map(e=>e):t.value=[]},u=n(!1),g=()=>{u.value=!u.value,u.value||(c.value=!1,t.value=[])},x=()=>{p.show({title:"\u786E\u5B9A\u5220\u9664\u5168\u90E8\u9009\u4E2D\uFF1F",message:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u6062\u590D",showCancel:!0,onEnter:async()=>{try{const e=t.value.map(S=>S.id),{data:a,error:s,msg:v}=await A({ids:e});if(s)return;g(),await r()}catch(e){console.log(e)}}})},B=e=>{p.show({title:"\u786E\u5B9A\u5220\u9664\uFF1F",message:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u6062\u590D",showCancel:!0,onEnter:async()=>{try{const{error:a,msg:s}=await b(e.id);if(a)return;await r()}catch(a){console.log(a)}}})},m=n(null),E=e=>{u.value&&g(),d.value=!0,m.value=e,l.value=e.name},O=async()=>{if(d.value){if(!l.value.trim())return;try{const{error:e}=await C(m.value.id,{name:l.value});if(e)return;await r(),h()}catch(e){console.log(e)}}else{if(!l.value.trim())return;try{const{data:e,error:a,msg:s}=await _({name:l.value});if(a)return;await r()}catch(e){console.log(e)}l.value=""}},h=()=>{d.value=!1,l.value=""};return o("batch",{isBatch:u,toggleBatch:g,batchDelete:x}),o("selected",{selectedData:t,setSelected:D}),o("selectAll",{isSelectAll:c,toggleSelectAll:U}),o("buttonOperation",{onDelete:B,onUpdate:E}),o("input",{inputValue:l,isUpdate:d,onAddOrUpdate:O,onCancelUpdate:h}),(e,a)=>(P(),G("div",null,[M(N(k))]))}});export{L as default};
